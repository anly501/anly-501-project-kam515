<!DOCTYPE html>
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    
<head>
    <title>501 project</title>

    <!-- point to css stylesheet -->
    <link rel="stylesheet" href="styles.css">
 
</head>

<body>


<!-- HEADER BAR -->
<ul>
    <!-- link back to homepage -->
    <li><a href="./Homepage_website.html">ABOUT ME</a></li>
    
    <!-- tab without dropdown  -->
    <li><a href="https://github.com/anly501/anly-501-project-kam515/tree/main/501-project-website/codes">CODE</a></li>

    <!-- tab without dropdown  -->
    <li><a href="https://github.com/anly501/anly-501-project-kam515/tree/main/data/00-raw-data">DATA</a></li>
    
    <!-- tab without dropdown  -->
    <li><a href="./Introduction.html">INTRODUCTION</a></li>
    
    <!-- tab without dropdown  -->
    <li><a href="./Data_Gathering.html">DATA GATHERING</a></li>
    
    <!-- tab without dropdown  -->
    <li><a href="./Data_Cleaning.html">DATA CLEANING</a></li>

    <!-- tab without dropdown  -->
    <li><a href="./Data_Exploration.html">EXPLORING DATA</a></li>    

    <!-- tab without dropdown  -->
    <li><a href="./Naive_Bayes.html">NAIVE BAYES</a></li>

    <!-- tab without dropdown  -->
    <li><a href="./Migrant_Decision_Tree.html">DECISION TREES</a></li>

    <!-- tab without dropdown  -->
    <li><a href="./Migrant_SVM.html">SVM</a></li>

    <!-- tab without dropdown  -->
    <li><a href="./Mead_HW_5.html">CLUSTERING</a></li>

    <!-- tab without dropdown  -->
    <li><a href="./Homepage_website.html">ARM AND NETWORKING</a></li>

    <!-- tab without dropdown  -->
    <li><a href="./Homepage_website.html">CONCLUSION</a></li>
    
    </ul>

<h1>
  Clustering
</h1>

<h2>
  Introduction
</h2>
<p>
  Using the migrant dataset, a decision tree was created to better subset the data and find relevant features. The decision tree was created using the scikitlearn package in python. However, before beginning the decision tree algorithm, a heat map and confusion matrix were constructed to better view the general trends and separability of the data. The confusion matrix showed a 99% accuracy at correctly identifying migrant and non-migrant district data. A clear separability in migrant and non-migrant districts was an interesting finding, but the question that follows is...why?
</p>
<h2>
  Theory
</h2>
<p>
  <b>KMEANS:</b>
</p>
<p>
  Kmeans is a clustering algorithm that is used to find clusters of data points. The clusters are not inherently significant in any way, but K-means clustering can be a strong tool for exploratory data analysis as it may reveal clustering in the data that otherwise wouldn't have been apparent. The algorithm works by randomly assigning the data points to clusters (the data scientist decides the number of clusters beforehand). The algorithm then calculates the distance between each data point and the center of each of the clusters. The data point is then assigned to the cluster with the shortest distance. The algorithm then recalculates the cluster center by taking the average of all the data points assigned to that cluster. The algorithm then repeats this process until the data points are reassigned to the most appropriate cluster. 
</p>
<p>
  It is not immediately apparent how many clusters is the optimal numer of clusters. The elbow method is a common method for determining the optimal number of clusters. The elbow method works by plotting the sum of squared distances between each data point and the cluster center. The optimal number of clusters is the point at which the sum of squared distances begins to level off. For the migrant dataset, the elbow method shows that the optimal number of clusters is about 4. This can be seen in the figure below (the "elbow" of the plot).
</p>
<p>
  <b>DBSAN:</b>
</p>
<p>
  DBSCAN is a clustering algorithm that is used to find clusters of data points based on high density regions. The algorithm works by first identifying a core point. A core point is a data point that has a minimum number of data points within a specified distance. The algorithm then identifies all the data points within the specified distance (pre-determined by the data scientist) of the core point and assigns them to the same cluster. The algorithm then repeats this process for each core point. The algorithm then identifies all the data points that are not core points and assigns them to a cluster if they are within a specified distance of a core point. The algorithm then repeats this process until all the data points have been assigned to a cluster.
</p>
<p>
  For the migrant dataset, the DBSAN algorithm returned approximately 17 clusters. The figure below shows the clusters that were returned by the algorithm. Black points are points considered to be "noise" and are not assigned to a cluster. DBSAN was not incredibly useful for this dataset as the clusters were not very distinct.
</p>
<p>
  <b>Hierarchical Clustering:</b>
</p>
<p>
  Hierarchical clustering is a clustering algorithm that can show a hierarchy of how a dataset can best be clustered. The algorithm works by first assigning each data point to its own cluster. The algorithm then identifies the two clusters that are the most similar and merges them into a single cluster. The algorithm then repeats this process until all the data points are assigned to this single cluster. The algorithm can be used to create a dendrogram, which is a tree-like diagram that shows the order in which the clusters were merged. The dendrogram can be used to determine the optimal number of clusters. The optimal number of clusters is the number of clusters that is the most significant in the dendrogram. 
</p>
<p>
  For the migrant dataset, the optimal number of clusters was approximately 4 as can be seen graphically in the dendrogram. The figure below shows the dendrogram for the migrant dataset. The optimal number of clusters is the number of clusters that is the most significant in the dendrogram.
</p>
<p>
  <b>Methods:</b>
</p>
<p>
  - Data Selection: The migrant dataset was used for this analysis. To clean this dataset, any school districts that had missing data for student enrollment were removed. This only reduced the 18,074 row dataset to 16,676 rows. For all other missing data points, the mean of the column was used to fill in the missing data.
</p>
<p>
  - Feature Selection: The feature variable chosen for this dataset was whether or not the district reported migrant students. The target variables were everything else in the dataset.
</p>
<p>
  - Hyperparameter Tuning: Each clustering algorithm has a number of hyperparameters that can be tuned to improve the performance of the algorithm. For Kmeans, the number of clusters was the only hyperparameter that was tuned. For DBSCAN, the minimum number of data points in a cluster and the distance between data points were the hyperparameters that were tuned. For hierarchical clustering, the distance metric and linkage method were the hyperparameters that were tuned.
</p>
<p>
  - Final Results: The final results for the most optimal hyperparameters for each algorithm are shown below.
</p>
<p>
  <b>Results:</b>
</p>
<p>
  Based on the graphs shown below, the most optimal clustering algorithm for this dataset was Kmeans. Kmeans was able to cluster the data into 4 distinct clusters. The clusters were not perfectly distinct, but they were distinct enough to be useful. The DBSCAN algorithm was not useful for this dataset as it returned 17 clusters with many noise points. The hierarchical clustering algorithm was useful in that it supported the 4 clusters that were returned by Kmeans. The dendrogram showed that the optimal number of clusters was approximately 4.
</p>
<p>
  <b>Conclusions:</b>
</p>
<p>
  The clustering algorithms used for this dataset were helpful in that they showed different ways in which the data could be clustered. More exploration is needed to better understand the trends that lead to the separation. Knowing these trends could help illuminate the reasons why migrant students are concentrated in certain areas.
</p>


<h1>
  Code:
</h1>

<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.247">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>mead_hw_5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="Mead_HW_5_files/libs/clipboard/clipboard.min.js"></script>
<script src="Mead_HW_5_files/libs/quarto-html/quarto.js"></script>
<script src="Mead_HW_5_files/libs/quarto-html/popper.min.js"></script>
<script src="Mead_HW_5_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Mead_HW_5_files/libs/quarto-html/anchor.min.js"></script>
<link href="Mead_HW_5_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Mead_HW_5_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Mead_HW_5_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Mead_HW_5_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Mead_HW_5_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">



<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># References:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co"># scikit-learn documentation</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># shared code from class</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Name: Katie Mead</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Date: 11-10-2022</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Class Section: 4</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="co"># ## Lab Section: 5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="import-libraries-and-load-the-dataset" class="level2">
<h2 class="anchored" data-anchor-id="import-libraries-and-load-the-dataset">Import libraries and load the dataset</h2>
<p>Make sure to drop the row-id column</p>
<div class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> seaborn <span class="im">as</span> sns</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.cluster.hierarchy <span class="im">as</span> sch</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sklearn.cluster <span class="im">as</span> cluster</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>sns.set_theme(style<span class="op">=</span><span class="st">"whitegrid"</span>, palette<span class="op">=</span><span class="st">'Set2'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> pd.read_csv(<span class="st">"/Users/katherinemead/Documents/GitHub/anly-501-project-kam515/501-project-website/codes/05-decision-trees/Migrant_Dataset.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>English language learners</th>
      <th>Enrollment</th>
      <th>Guidance counselors</th>
      <th>instructional_aides_fte</th>
      <th>lea_admin_support_staff_fte</th>
      <th>lea_administrators_fte</th>
      <th>librarian_specialists_fte</th>
      <th>librarian_support_staff_fte</th>
      <th>number_of_schools</th>
      <th>other_staff_fte</th>
      <th>...</th>
      <th>support_staff_other_fte</th>
      <th>support_staff_stu_wo_psych_fte</th>
      <th>support_staff_students_fte</th>
      <th>teachers_elementary_fte</th>
      <th>teachers_kindergarten_fte</th>
      <th>teachers_prek_fte</th>
      <th>teachers_secondary_fte</th>
      <th>teachers_total_fte</th>
      <th>teachers_ungraded_fte</th>
      <th>migrantYN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>-1</td>
      <td>71</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>7</td>
      <td>0</td>
      <td>...</td>
      <td>-1</td>
      <td>0</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-1</td>
      <td>-2</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>770</td>
      <td>3790</td>
      <td>8</td>
      <td>-1</td>
      <td>-1</td>
      <td>2</td>
      <td>7</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>...</td>
      <td>134</td>
      <td>0</td>
      <td>10</td>
      <td>111</td>
      <td>24</td>
      <td>1</td>
      <td>89</td>
      <td>225</td>
      <td>-2</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>436</td>
      <td>5647</td>
      <td>15</td>
      <td>-1</td>
      <td>-1</td>
      <td>2</td>
      <td>13</td>
      <td>4</td>
      <td>15</td>
      <td>0</td>
      <td>...</td>
      <td>294</td>
      <td>0</td>
      <td>17</td>
      <td>180</td>
      <td>38</td>
      <td>5</td>
      <td>167</td>
      <td>390</td>
      <td>-2</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>758</td>
      <td>12479</td>
      <td>32</td>
      <td>-1</td>
      <td>-1</td>
      <td>2</td>
      <td>17</td>
      <td>17</td>
      <td>16</td>
      <td>0</td>
      <td>...</td>
      <td>744</td>
      <td>0</td>
      <td>45</td>
      <td>447</td>
      <td>101</td>
      <td>9</td>
      <td>457</td>
      <td>1015</td>
      <td>-2</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>368</td>
      <td>8298</td>
      <td>17</td>
      <td>-1</td>
      <td>-1</td>
      <td>1</td>
      <td>11</td>
      <td>9</td>
      <td>10</td>
      <td>0</td>
      <td>...</td>
      <td>331</td>
      <td>0</td>
      <td>34</td>
      <td>209</td>
      <td>45</td>
      <td>4</td>
      <td>223</td>
      <td>481</td>
      <td>-2</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>
</div>
</div>
<div class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># change all negative numbers to nan</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.replace(<span class="op">-</span><span class="dv">1</span>, np.nan)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.replace(<span class="op">-</span><span class="dv">2</span>, np.nan)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>df.head()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>English language learners</th>
      <th>Enrollment</th>
      <th>Guidance counselors</th>
      <th>instructional_aides_fte</th>
      <th>lea_admin_support_staff_fte</th>
      <th>lea_administrators_fte</th>
      <th>librarian_specialists_fte</th>
      <th>librarian_support_staff_fte</th>
      <th>number_of_schools</th>
      <th>other_staff_fte</th>
      <th>...</th>
      <th>support_staff_other_fte</th>
      <th>support_staff_stu_wo_psych_fte</th>
      <th>support_staff_students_fte</th>
      <th>teachers_elementary_fte</th>
      <th>teachers_kindergarten_fte</th>
      <th>teachers_prek_fte</th>
      <th>teachers_secondary_fte</th>
      <th>teachers_total_fte</th>
      <th>teachers_ungraded_fte</th>
      <th>migrantYN</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>NaN</td>
      <td>71.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>0</td>
      <td>...</td>
      <td>NaN</td>
      <td>0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>No</td>
    </tr>
    <tr>
      <th>1</th>
      <td>770.0</td>
      <td>3790.0</td>
      <td>8.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>7.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>0</td>
      <td>...</td>
      <td>134.0</td>
      <td>0</td>
      <td>10.0</td>
      <td>111.0</td>
      <td>24.0</td>
      <td>1.0</td>
      <td>89.0</td>
      <td>225.0</td>
      <td>NaN</td>
      <td>No</td>
    </tr>
    <tr>
      <th>2</th>
      <td>436.0</td>
      <td>5647.0</td>
      <td>15.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>13.0</td>
      <td>4.0</td>
      <td>15.0</td>
      <td>0</td>
      <td>...</td>
      <td>294.0</td>
      <td>0</td>
      <td>17.0</td>
      <td>180.0</td>
      <td>38.0</td>
      <td>5.0</td>
      <td>167.0</td>
      <td>390.0</td>
      <td>NaN</td>
      <td>No</td>
    </tr>
    <tr>
      <th>3</th>
      <td>758.0</td>
      <td>12479.0</td>
      <td>32.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2.0</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>16.0</td>
      <td>0</td>
      <td>...</td>
      <td>744.0</td>
      <td>0</td>
      <td>45.0</td>
      <td>447.0</td>
      <td>101.0</td>
      <td>9.0</td>
      <td>457.0</td>
      <td>1015.0</td>
      <td>NaN</td>
      <td>No</td>
    </tr>
    <tr>
      <th>4</th>
      <td>368.0</td>
      <td>8298.0</td>
      <td>17.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>11.0</td>
      <td>9.0</td>
      <td>10.0</td>
      <td>0</td>
      <td>...</td>
      <td>331.0</td>
      <td>0</td>
      <td>34.0</td>
      <td>209.0</td>
      <td>45.0</td>
      <td>4.0</td>
      <td>223.0</td>
      <td>481.0</td>
      <td>NaN</td>
      <td>No</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 27 columns</p>
</div>
</div>
</div>
</section>
<section id="exploratory-data-analysis" class="level2">
<h2 class="anchored" data-anchor-id="exploratory-data-analysis">Exploratory Data Analysis</h2>
<p>As we have seen in past labs, we typically want to get inside and explore the data a bit before doing analysis.</p>
<div class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Check the number of rows and columns in the dataset</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(18074, 27)</code></pre>
</div>
</div>
<div class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">## Get the data types of the columns</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.info())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 18074 entries, 0 to 18073
Data columns (total 27 columns):
 #   Column                          Non-Null Count  Dtype  
---  ------                          --------------  -----  
 0   English language learners       12643 non-null  float64
 1   Enrollment                      16676 non-null  float64
 2   Guidance counselors             14801 non-null  float64
 3   instructional_aides_fte         14772 non-null  float64
 4   lea_admin_support_staff_fte     13640 non-null  float64
 5   lea_administrators_fte          15658 non-null  float64
 6   librarian_specialists_fte       14132 non-null  float64
 7   librarian_support_staff_fte     11229 non-null  float64
 8   number_of_schools               17834 non-null  float64
 9   other_staff_fte                 18074 non-null  int64  
 10  school_admin_support_staff_fte  14475 non-null  float64
 11  school_administrators_fte       15759 non-null  float64
 12  school_counselors_fte           18074 non-null  int64  
 13  school_psychologists_fte        18074 non-null  int64  
 14  school_staff_total_fte          18074 non-null  int64  
 15  spec_ed_students                13754 non-null  float64
 16  supervisory_union_number        17834 non-null  float64
 17  support_staff_other_fte         14684 non-null  float64
 18  support_staff_stu_wo_psych_fte  18074 non-null  int64  
 19  support_staff_students_fte      14654 non-null  float64
 20  teachers_elementary_fte         15897 non-null  float64
 21  teachers_kindergarten_fte       14428 non-null  float64
 22  teachers_prek_fte               11919 non-null  float64
 23  teachers_secondary_fte          15539 non-null  float64
 24  teachers_total_fte              16422 non-null  float64
 25  teachers_ungraded_fte           9622 non-null   float64
 26  migrantYN                       18074 non-null  object 
dtypes: float64(21), int64(5), object(1)
memory usage: 3.7+ MB
None</code></pre>
</div>
</div>
<section id="check-for-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="check-for-missing-values">Check for missing values</h3>
<div class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.isnull().<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>English language learners         5431
Enrollment                        1398
Guidance counselors               3273
instructional_aides_fte           3302
lea_admin_support_staff_fte       4434
lea_administrators_fte            2416
librarian_specialists_fte         3942
librarian_support_staff_fte       6845
number_of_schools                  240
other_staff_fte                      0
school_admin_support_staff_fte    3599
school_administrators_fte         2315
school_counselors_fte                0
school_psychologists_fte             0
school_staff_total_fte               0
spec_ed_students                  4320
supervisory_union_number           240
support_staff_other_fte           3390
support_staff_stu_wo_psych_fte       0
support_staff_students_fte        3420
teachers_elementary_fte           2177
teachers_kindergarten_fte         3646
teachers_prek_fte                 6155
teachers_secondary_fte            2535
teachers_total_fte                1652
teachers_ungraded_fte             8452
migrantYN                            0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># drop rows with missing enrollment</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df.dropna(subset<span class="op">=</span>[<span class="st">'Enrollment'</span>])</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.shape)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(16676, 27)</code></pre>
</div>
</div>
<p>Let’s check unique values for categorical columns.</p>
<p>Common options for handling unusual data include;</p>
<ol type="1">
<li><p>replace un-expected values it with the most frequent value (for categorical columns), and with the mean value (for numerical columns)</p></li>
<li><p>delete the row with missing or unusual values</p></li>
</ol>
<p>There are a lot of missing values in <code>sex</code> column, make a conscious decision on how to handle them.</p>
<p>Write two+ lines on what procedure and logic you used to make that decision.</p>
<p>For example, you can write, “I chose to replace values for Adelie penguins on Torgersen island to be all male (or x% male and (1-x)% female)… I chose this procedure because number of penguins male penguins were underrepresented (a usual ratio is for mammels is around 55% female and 45% males)”replace the missing values with the most frequent value in the column.</p>
<div class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df[<span class="st">'migrantYN'</span>].unique()) <span class="co"># print islands of penguins</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>['No' 'Yes']</code></pre>
</div>
</div>
<div class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the number of penguins in each island</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>sns.countplot(x<span class="op">=</span><span class="st">'migrantYN'</span>, data<span class="op">=</span>df)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Mead_HW_5_files/figure-html/cell-12-output-1.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get average English language learners for migrant==Yes and migrant==No</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df.groupby(<span class="st">'migrantYN'</span>)[<span class="st">'English language learners'</span>].mean())</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the average English language learners for migrant==Yes and migrant==No</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>sns.barplot(x<span class="op">=</span><span class="st">'migrantYN'</span>, y<span class="op">=</span><span class="st">'English language learners'</span>, data<span class="op">=</span>df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>migrantYN
No     169.287617
Yes    718.444717
Name: English language learners, dtype: float64</code></pre>
</div>
<div class="cell-output cell-output-display" data-execution_count="40">
<pre><code>&lt;AxesSubplot:xlabel='migrantYN', ylabel='English language learners'&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Mead_HW_5_files/figure-html/cell-13-output-3.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># filling all missing values with the mean of the column</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>columns_list <span class="op">=</span> []</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> df.columns[:<span class="op">-</span><span class="dv">1</span>]:</span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>    columns_list.append(i)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> columns_list:</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>    df[i] <span class="op">=</span> df[i].fillna(value <span class="op">=</span> df[i].mean())</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>df.isna().<span class="bu">sum</span>() <span class="co"># check that there are no more missing values</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="41">
<pre><code>English language learners         0
Enrollment                        0
Guidance counselors               0
instructional_aides_fte           0
lea_admin_support_staff_fte       0
lea_administrators_fte            0
librarian_specialists_fte         0
librarian_support_staff_fte       0
number_of_schools                 0
other_staff_fte                   0
school_admin_support_staff_fte    0
school_administrators_fte         0
school_counselors_fte             0
school_psychologists_fte          0
school_staff_total_fte            0
spec_ed_students                  0
supervisory_union_number          0
support_staff_other_fte           0
support_staff_stu_wo_psych_fte    0
support_staff_students_fte        0
teachers_elementary_fte           0
teachers_kindergarten_fte         0
teachers_prek_fte                 0
teachers_secondary_fte            0
teachers_total_fte                0
teachers_ungraded_fte             0
migrantYN                         0
dtype: int64</code></pre>
</div>
</div>
<div class="cell" data-execution_count="55">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get the length of every column</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> df.columns:</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i, <span class="bu">len</span>(df[i]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>English language learners 16676
Enrollment 16676
Guidance counselors 16676
instructional_aides_fte 16676
lea_admin_support_staff_fte 16676
lea_administrators_fte 16676
librarian_specialists_fte 16676
librarian_support_staff_fte 16676
number_of_schools 16676
other_staff_fte 16676
school_admin_support_staff_fte 16676
school_administrators_fte 16676
school_counselors_fte 16676
school_psychologists_fte 16676
school_staff_total_fte 16676
spec_ed_students 16676
supervisory_union_number 16676
support_staff_other_fte 16676
support_staff_stu_wo_psych_fte 16676
support_staff_students_fte 16676
teachers_elementary_fte 16676
teachers_kindergarten_fte 16676
teachers_prek_fte 16676
teachers_secondary_fte 16676
teachers_total_fte 16676
teachers_ungraded_fte 16676
migrantYN 16676</code></pre>
</div>
</div>
</section>
</section>
<section id="seperate-the-dataset-into-features-and-labels" class="level1">
<h1>Seperate the dataset into features and labels</h1>
<div class="cell" data-execution_count="56">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.model_selection <span class="im">import</span> train_test_split <span class="co"># import train_test_split function</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler <span class="co"># import StandardScaler</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split dataset into features (x) and target variable (y)</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> df.drop([<span class="st">'migrantYN'</span>], axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># X is all the columns except species</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> df[<span class="st">'migrantYN'</span>] <span class="co"># y is the species column</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>scalar <span class="op">=</span> StandardScaler() <span class="co"># create a scaler object</span></span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>scalar.fit(X) <span class="co"># fit the scaler to the features</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>X <span class="op">=</span> scalar.transform(X) </span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a><span class="co">#X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="perform-k-means" class="level1">
<h1>Perform K-means</h1>
<div class="cell" data-execution_count="57">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> statistics <span class="im">import</span> mode</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> KMeans</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.spatial.distance <span class="im">import</span> cdist </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> classification_report, confusion_matrix, ConfusionMatrixDisplay,accuracy_score</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> threadpoolctl <span class="im">import</span> threadpool_limits</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="58">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>distortions <span class="op">=</span> [] </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>inertias <span class="op">=</span> []</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>k <span class="op">=</span> <span class="dv">11</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,k): </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    kmeanModel <span class="op">=</span> KMeans(n_clusters<span class="op">=</span>k,init <span class="op">=</span> <span class="st">'k-means++'</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    kmeanModel.fit(X)     </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>    distortions.append(<span class="bu">sum</span>(np.<span class="bu">min</span>(cdist(X, kmeanModel.cluster_centers_, <span class="st">'euclidean'</span>),axis<span class="op">=</span><span class="dv">1</span>)) <span class="op">/</span> X.shape[<span class="dv">0</span>]) </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>    inertias.append(kmeanModel.inertia_) </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>    evaluation <span class="op">=</span> pd.DataFrame.from_records({<span class="st">'Cluster'</span>:np.arange(<span class="dv">1</span>,k<span class="op">+</span><span class="dv">1</span>), <span class="st">'Distortion'</span>:distortions, <span class="st">'Inertia'</span>:inertias})</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>evaluation</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="58">

<div>

<table class="dataframe table table-sm table-striped">
  <thead>
    <tr>
      <th></th>
      <th>Cluster</th>
      <th>Distortion</th>
      <th>Inertia</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1.531624</td>
      <td>350196.000000</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1.405160</td>
      <td>219474.382035</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>1.246938</td>
      <td>163630.301676</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>1.197275</td>
      <td>130396.765683</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>1.112973</td>
      <td>115074.079469</td>
    </tr>
    <tr>
      <th>5</th>
      <td>6</td>
      <td>1.111899</td>
      <td>100052.112334</td>
    </tr>
    <tr>
      <th>6</th>
      <td>7</td>
      <td>1.109342</td>
      <td>87897.644313</td>
    </tr>
    <tr>
      <th>7</th>
      <td>8</td>
      <td>1.013939</td>
      <td>77840.256356</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9</td>
      <td>0.955510</td>
      <td>73295.951176</td>
    </tr>
    <tr>
      <th>9</th>
      <td>10</td>
      <td>0.949423</td>
      <td>68666.954725</td>
    </tr>
  </tbody>
</table>
</div>
</div>
</div>
<div class="cell" data-execution_count="59">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>evaluation.plot.line(x <span class="op">=</span> <span class="st">'Cluster'</span>,subplots<span class="op">=</span><span class="va">True</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="59">
<pre><code>array([&lt;AxesSubplot:xlabel='Cluster'&gt;, &lt;AxesSubplot:xlabel='Cluster'&gt;],
      dtype=object)</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Mead_HW_5_files/figure-html/cell-19-output-2.png" class="img-fluid"></p>
</div>
</div>
<div class="cell" data-execution_count="70">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># K means with 4 clusters</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>kmeans <span class="op">=</span> KMeans(n_clusters<span class="op">=</span><span class="dv">4</span>, init <span class="op">=</span> <span class="st">'k-means++'</span>, random_state <span class="op">=</span> <span class="dv">42</span>)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>kmeans.fit(X)</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>y_kmeans <span class="op">=</span> kmeans.predict(X)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="co"># plot the clusters</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>plt.scatter(X[:, <span class="dv">0</span>], X[:, <span class="dv">1</span>], c<span class="op">=</span>y_kmeans, s<span class="op">=</span><span class="dv">50</span>, cmap<span class="op">=</span><span class="st">'viridis'</span>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>centers <span class="op">=</span> kmeans.cluster_centers_</span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>plt.scatter(centers[:, <span class="dv">0</span>], centers[:, <span class="dv">1</span>], c<span class="op">=</span><span class="st">'black'</span>, s<span class="op">=</span><span class="dv">200</span>, alpha<span class="op">=</span><span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Mead_HW_5_files/figure-html/cell-20-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="perform-dbscan-and-predict-the-labels" class="level1">
<h1>Perform DBSCAN and predict the labels</h1>
<div class="cell" data-execution_count="60">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> DBSCAN</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn <span class="im">import</span> metrics</span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.datasets <span class="im">import</span> make_blobs</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="63">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> DBSCAN</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>db <span class="op">=</span> DBSCAN(eps<span class="op">=</span><span class="fl">2.5</span>, min_samples<span class="op">=</span><span class="dv">2</span>).fit(X)</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>core_samples_mask <span class="op">=</span> np.zeros_like(db.labels_, dtype<span class="op">=</span><span class="bu">bool</span>)</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>core_samples_mask[db.core_sample_indices_] <span class="op">=</span> <span class="va">True</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> db.labels_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="65">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Number of clusters in labels, ignoring noise if present.</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>n_clusters_ <span class="op">=</span> <span class="bu">len</span>(<span class="bu">set</span>(labels)) <span class="op">-</span> (<span class="dv">1</span> <span class="cf">if</span> <span class="op">-</span><span class="dv">1</span> <span class="kw">in</span> labels <span class="cf">else</span> <span class="dv">0</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>n_noise_ <span class="op">=</span> <span class="bu">list</span>(labels).count(<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Black removed and is used for noise instead.</span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>unique_labels <span class="op">=</span> <span class="bu">set</span>(labels)</span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> [plt.cm.Spectral(each) <span class="cf">for</span> each <span class="kw">in</span> np.linspace(<span class="dv">0</span>, <span class="dv">1</span>, <span class="bu">len</span>(unique_labels))]</span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, col <span class="kw">in</span> <span class="bu">zip</span>(unique_labels, colors):</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> k <span class="op">==</span> <span class="op">-</span><span class="dv">1</span>:</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Black used for noise.</span></span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>        col <span class="op">=</span> [<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>]</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a>    class_member_mask <span class="op">=</span> labels <span class="op">==</span> k</span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a>    xy <span class="op">=</span> X[class_member_mask <span class="op">&amp;</span> core_samples_mask]</span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>    plt.plot(</span>
<span id="cb32-19"><a href="#cb32-19" aria-hidden="true" tabindex="-1"></a>        xy[:, <span class="dv">0</span>],</span>
<span id="cb32-20"><a href="#cb32-20" aria-hidden="true" tabindex="-1"></a>        xy[:, <span class="dv">1</span>],</span>
<span id="cb32-21"><a href="#cb32-21" aria-hidden="true" tabindex="-1"></a>        <span class="st">"o"</span>,</span>
<span id="cb32-22"><a href="#cb32-22" aria-hidden="true" tabindex="-1"></a>        markerfacecolor<span class="op">=</span><span class="bu">tuple</span>(col),</span>
<span id="cb32-23"><a href="#cb32-23" aria-hidden="true" tabindex="-1"></a>        markeredgecolor<span class="op">=</span><span class="st">"k"</span>,</span>
<span id="cb32-24"><a href="#cb32-24" aria-hidden="true" tabindex="-1"></a>        markersize<span class="op">=</span><span class="dv">14</span>,</span>
<span id="cb32-25"><a href="#cb32-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-26"><a href="#cb32-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-27"><a href="#cb32-27" aria-hidden="true" tabindex="-1"></a>    xy <span class="op">=</span> X[class_member_mask <span class="op">&amp;</span> <span class="op">~</span>core_samples_mask]</span>
<span id="cb32-28"><a href="#cb32-28" aria-hidden="true" tabindex="-1"></a>    plt.plot(</span>
<span id="cb32-29"><a href="#cb32-29" aria-hidden="true" tabindex="-1"></a>        xy[:, <span class="dv">0</span>],</span>
<span id="cb32-30"><a href="#cb32-30" aria-hidden="true" tabindex="-1"></a>        xy[:, <span class="dv">1</span>],</span>
<span id="cb32-31"><a href="#cb32-31" aria-hidden="true" tabindex="-1"></a>        <span class="st">"o"</span>,</span>
<span id="cb32-32"><a href="#cb32-32" aria-hidden="true" tabindex="-1"></a>        markerfacecolor<span class="op">=</span><span class="bu">tuple</span>(col),</span>
<span id="cb32-33"><a href="#cb32-33" aria-hidden="true" tabindex="-1"></a>        markeredgecolor<span class="op">=</span><span class="st">"k"</span>,</span>
<span id="cb32-34"><a href="#cb32-34" aria-hidden="true" tabindex="-1"></a>        markersize<span class="op">=</span><span class="dv">6</span>,</span>
<span id="cb32-35"><a href="#cb32-35" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb32-36"><a href="#cb32-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-37"><a href="#cb32-37" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Estimated number of clusters: </span><span class="sc">%d</span><span class="st">"</span> <span class="op">%</span> n_clusters_)</span>
<span id="cb32-38"><a href="#cb32-38" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Mead_HW_5_files/figure-html/cell-23-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="agglomerative-clustering-hierarchical-clustering" class="level1">
<h1>Agglomerative Clustering (Hierarchical clustering)</h1>
<div class="cell" data-execution_count="66">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.cluster.hierarchy <span class="im">import</span> dendrogram, linkage</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> AgglomerativeClustering</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> AgglomerativeClustering().fit(X)</span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> model.labels_</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>### Plot the clusters for Agglomerative Clustering</p>
<div class="cell" data-execution_count="67">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>Z <span class="op">=</span> linkage(X, method<span class="op">=</span><span class="st">'ward'</span>) <span class="co"># method can be single, complete, average, centroid, median, ward</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>dend <span class="op">=</span> dendrogram(Z)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>plt.axhline(y<span class="op">=</span><span class="dv">5</span>, color<span class="op">=</span><span class="st">'r'</span>, linestyle<span class="op">=</span><span class="st">'--'</span>, label<span class="op">=</span><span class="st">'5'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="67">
<pre><code>&lt;matplotlib.lines.Line2D at 0x7f99698bfa90&gt;</code></pre>
</div>
<div class="cell-output cell-output-display">
<p><img src="Mead_HW_5_files/figure-html/cell-25-output-2.png" class="img-fluid"></p>
</div>
</div>
</section>
<section id="mean-shift" class="level1">
<h1>Mean Shift</h1>
<div class="cell" data-execution_count="68">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.cluster <span class="im">import</span> MeanShift, estimate_bandwidth</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> cycle</span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>model <span class="op">=</span> MeanShift(bandwidth<span class="op">=</span><span class="dv">2</span>).fit(X)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>labels <span class="op">=</span> model.labels_</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>cluster_centers <span class="op">=</span> model.cluster_centers_</span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>labels_unique <span class="op">=</span> np.unique(labels)</span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>n_clusters_ <span class="op">=</span> <span class="bu">len</span>(labels_unique)</span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"number of estimated clusters : </span><span class="sc">%d</span><span class="st">"</span> <span class="op">%</span> n_clusters_)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>number of estimated clusters : 480</code></pre>
</div>
</div>
<p>### Plot the clusters for Mean Shift Clustering</p>
<div class="cell" data-execution_count="69">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> itertools <span class="im">import</span> cycle</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>plt.figure(<span class="dv">1</span>)</span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>plt.clf()</span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>colors <span class="op">=</span> cycle(<span class="st">"bgrcmykbgrcmykbgrcmykbgrcmyk"</span>)</span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> k, col <span class="kw">in</span> <span class="bu">zip</span>(<span class="bu">range</span>(n_clusters_), colors):</span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    my_members <span class="op">=</span> labels <span class="op">==</span> k</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    cluster_center <span class="op">=</span> cluster_centers[k]</span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    plt.plot(X[my_members, <span class="dv">0</span>], X[my_members, <span class="dv">1</span>], col <span class="op">+</span> <span class="st">"."</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>    plt.plot(</span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a>        cluster_center[<span class="dv">0</span>],</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a>        cluster_center[<span class="dv">1</span>],</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>        <span class="st">"o"</span>,</span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>        markerfacecolor<span class="op">=</span>col,</span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>        markeredgecolor<span class="op">=</span><span class="st">"k"</span>,</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>        markersize<span class="op">=</span><span class="dv">14</span>,</span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">"Estimated number of clusters: </span><span class="sc">%d</span><span class="st">"</span> <span class="op">%</span> n_clusters_)</span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<p><img src="Mead_HW_5_files/figure-html/cell-27-output-1.png" class="img-fluid"></p>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>